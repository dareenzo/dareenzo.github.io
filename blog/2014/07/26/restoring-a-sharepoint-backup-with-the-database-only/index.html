<!DOCTYPE html><html class="no-js"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#"><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="x-dns-prefetch-control" content="on"/><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="anonymous"><link rel="prerender" href="/blog/2014/08/03/unit-tests-with-smtp/" /><link rel="prerender" href="/blog/2014/07/25/measuring-query-progress-in-sql-server/" /><title>Restaurando um backup de Share Point usando apenas a base dados &middot; Paulo Phagula</title><meta name="description" content="Então você tem que restaurar um backup de SharePoint mas não consegue fazê-lousando a interface do Central Administration, pelos mais variados erros.No entan..."><link rel="canonical" href="https://dareenzo.github.io/blog/2014/07/26/restoring-a-sharepoint-backup-with-the-database-only/"><link rel="prev" href="/blog/2014/07/25/measuring-query-progress-in-sql-server/" title="Measuring query progress in SQL Server with DBCC!" /><link rel="next" href="/blog/2014/08/03/unit-tests-with-smtp/" title="Testes unitários com SmtpClient" /><meta name="HandheldFriendly" content="True" /><meta name="MobileOptimized" content="320" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" /><meta name="format-detection" content="telephone=no" /><meta http-equiv="x-rim-auto-match" content="none" /><meta http-equiv="cleartype" content="on"><meta name="mobile-web-app-capable" content="yes"><link rel="icon" sizes="192x192" href="/assets/images/favicons/android-chrome-192x192.png"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#333"><link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab.svg" color="#333"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Paulo Phagula"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon.png"><meta name="generator" content="jekyll"><meta name="revisit-after" content="1 DAYS"><meta name="author" content="Paulo Phagula" /><link rel="publisher" href="https://plus.google.com/+PauloPhagula" /><link rel="author" href="/about"><meta name="contact" content="pphagula@gmail.com" /><meta name="geography" content="Mozambique"><meta name="source" content="https://github.com/dareenzo/dareenzo.github.io"> <!-- twitter meta --><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@dareenzo" /><meta name="twitter:creator" content="@dareenzo"><meta name="twitter:url" content="https://dareenzo.github.io/blog/2014/07/26/restoring-a-sharepoint-backup-with-the-database-only/" /> <!-- opengraph --><meta property="og:type" content="website" /><meta property="og:url" content="https://dareenzo.github.io/blog/2014/07/26/restoring-a-sharepoint-backup-with-the-database-only/" /><meta property="og:site_name" content="Paulo Phagula" /> <!-- SEO Property Combo --><meta property="og:title" name="twitter:title" itemprop="title name" content="Restaurando um backup de Share Point usando apenas a base dados &middot; Paulo Phagula" /><meta property="og:description" name="twitter:description" itemprop="description" content="Então você tem que restaurar um backup de SharePoint mas não consegue fazê-lousando a interface do Central Administration, pelos mais variados erros.No entan..." /><meta property="og:image" name="twitter:image" itemprop="image primaryImageOfPage" content="https://dareenzo.github.io/assets/images/facebook-share.png" /><link rel="alternate" type="application/atom+xml" title="Paulo Phagula &raquo; Atom Feed" href="https://dareenzo.github.io/feed.atom.xml"><link rel="alternate" type="application/rss+xml" title="Paulo Phagula &raquo; RSS Feed" href="https://dareenzo.github.io/feed.rss.xml"><meta name="google-site-verification" content="hXGNVG1mBEAHY0UFP_2RAzcWhzVKmQmWLbAtqPAafog" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/themes/prism.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/plugins/toolbar/prism-toolbar.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css"><style type="text/css"> /*! normalize.css v8.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.hidden{display:none !important}.visuallyhidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}.visuallyhidden.focusable:active,.visuallyhidden.focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto;white-space:inherit}.invisible{visibility:hidden}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.no-list{list-style:none;margin:0;padding:0}.no-list>li{margin:0;padding:0}.text-right{text-align:right}.text-left{text-align:left}.text-center{text-align:center}.text-justify{text-align:justify}.text-uppercase{text-transform:uppercase}.text-lowercase{text-transform:lowercase}.left,.float-left{float:left}.right,.float-right{float:right}.pull-right{float:right !important}.pull-left{float:left !important}*{box-sizing:border-box}html{color:#222;font-size:1em;line-height:1.4}body{color:#44484a;text-rendering:optimizeLegibility;font-size:18px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Android Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:1.5;height:100%;margin:0 auto;overflow-y:scroll;visibility:visible;word-break:break-word;word-wrap:break-word}body,input,button{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1,h2,h3,h4,h5,h6{margin:20px 0 14px 0;color:#262626;font-weight:600;line-height:1.25}h1{font-size:2em}h2{font-size:1.5em}h3{font-size:1.17em}h4{font-size:1em}h5{font-size:0.83em}h6{font-size:0.75em}p{line-height:1.5;margin:15px 0}hr{display:block;height:1px;border:0;border-top:1px solid #ddd;margin:1em 0;padding:0;overflow:hidden;background:transparent}audio,canvas,iframe,img,svg,video{vertical-align:middle}del{text-decoration:line-through;color:#999}ins{color:#000}img{max-width:100%}img.emoji{width:20px !important;margin:0px !important;float:none !important;border:none !important}.img--circle{border-radius:50%}::selection{background:#b3d4fc;text-shadow:none}::-moz-selection{background:#b3d4fc;text-shadow:none}a:link,a:visited{text-decoration:none;color:#4492ff}a:hover{text-decoration:underline}b,strong{font-weight:bold}em{font-style:italic}pre{padding:16px;overflow:auto;line-height:1.45;background-color:#f6f8fa;border-radius:3px;word-wrap:normal;margin-top:0;margin-bottom:16px}code{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Roboto Mono","Courier New",Courier,monospace !important;font-size:0.9em;padding:0.2em 0.4em;margin:0;background-color:rgba(27,31,35,0.05);border-radius:3px}pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:transparent;border:0}blockquote{font-style:italic;border-left:2px solid #4492ff;padding-left:15px;margin-left:0}ul,ol{padding:0;margin:0 0 10px 10px;padding-left:5px;list-style-position:outside;display:block}ul li ul,ul li ol{padding:0;margin:0 0 0px 10px;padding-left:5px;list-style-position:outside;display:block;font-size:inherit}ul{list-style-type:disc}ol{list-style-type:decimal}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}table{margin-top:0;margin-bottom:16px;display:block;width:100%;overflow:auto}table tr{background-color:#fff;border-top:1px solid #c6cbd1}table th{font-weight:600}table th,table td{padding:6px 13px;border:1px solid #dfe2e5}fieldset{border:0;margin:0;padding:0}textarea{resize:vertical}input[type="text"],input[type="password"],input[type="date"],input[type="datetime"],input[type="datetime-local"],input[type="month"],input[type="week"],input[type="email"],input[type="number"],input[type="search"],input[type="tel"],input[type="time"],input[type="url"],textarea{outline:0px none;-webkit-appearance:none;-moz-appearance:none;color:rgba(0,0,0,0.75);display:block;margin:0;padding:5px 3px;height:25px;width:100%;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;transition:border-color 0.15s ease-in-out 0s;-webkit-transition:border-color 0.15s ease-in-out 0s;-moz-transition:border-color 0.15s ease-in-out 0s;-ms-transition:border-color 0.15s ease-in-out 0s;-o-transition:border-color 0.15s ease-in-out 0s;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;border:1px solid #e3e3e3}textarea{height:71px}input[type="text"]:focus,input[type="password"]:focus,input[type="date"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="email"]:focus,input[type="number"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="time"]:focus,input[type="url"]:focus,textarea:focus{border-color:#4492ff;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;outline:0px none}button{cursor:pointer;border-radius:0}details summary{cursor:pointer}details:not([open])>*:not(summary){display:none}.button{-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,0.05);box-shadow:0 1px 0 rgba(0,0,0,0.05);-webkit-transition:background-color .218s,border-color .218s,box-shadow .218s;transition:background-color .218s,border-color .218s,box-shadow .218s;-webkit-user-select:none;user-select:none;background-color:#fff;border:1px solid #d9d9d9;cursor:pointer;height:28px;line-height:28px;padding:0 10px 0 10px;outline:none;width:auto;background-image:none;-webkit-appearance:none;margin:0}label{margin-bottom:5px;margin-top:10px;display:block}.button:hover{-webkit-box-shadow:0 1px 0 rgba(0,0,0,0.1);box-shadow:0 1px 0 rgba(0,0,0,0.1);border-color:#bfbfbf}.button:active{-webkit-box-shadow:inset 0 1px 0 #ddd;box-shadow:inset 0 1px 0 #ddd;background-color:#e5e5e5;border-color:#bfbfbf}.form-button{padding-top:20px;margin-bottom:40px}::-webkit-input-placeholder{vertical-align:middle;padding:3px 2px}:-moz-placeholder{vertical-align:middle;margin:3px 2px}::-moz-placeholder{vertical-align:middle;margin:3px 2px}:-ms-input-placeholder{vertical-align:middle;margin:3px 2px}main{width:740px;margin:0 auto}.header{width:740px;margin:15px auto;text-align:center}.header .header__search-box{width:300px;margin:0 auto}.header a{text-decoration:underline;font-weight:bold}.logo{width:80px}.header__navigation{margin:20px}.navigation{font-size:.9em}nav ul{list-style-type:none;padding:0;margin:0 0;list-style-position:outside;display:block}nav ul li{display:inline}nav ul li:after{content:"";margin:0 5px;color:#aaaaaa}nav ul li:last-child:after{content:""}.posts-list{list-style:none outside;margin:0}.posts-list-item{position:relative}.posts-list time{position:absolute;left:0;top:0}.posts-list .post-link{display:block;padding-left:4.5em}#content{max-width:740px;width:740px}#content article:first-child{margin-top:0px;min-height:300px !important}#content article{margin:15px;padding:0 15px 15px 15px}#content article header img.author{width:50px;float:left;margin-right:10px;margin-bottom:15px}#content article header strong{display:block;color:#262626}.article__title{font-size:2.5em;letter-spacing:-1.79px;line-height:1.1em}.article__meta{font-size:.75em;color:#aaadad}.excerpt img{float:left;margin-right:15px;margin-bottom:15px;max-width:120px;max-height:120px}.excerpt a.title{color:#4492ff;line-height:1.4;font-size:16px;font-style:normal;font-variant:normal;font-weight:300;max-height:157px;font-size-adjust:none;font-stretch:normal}.excerpt .tags{list-style-type:none;display:inline}.excerpt .tags li{display:inline;background-color:rgba(0,0,0,0.05);background-color:white}.excerpt .tags li:after{content:', ';color:#999}.excerpt .tags li:last-child:after{content:""}.article__excerpt{font-style:italic;padding:10px}footer{text-align:center;padding-top:2rem;padding-bottom:2rem;background:#f3f7f9;background:#fafcfc;color:#596a73}.copyright{font-size:75%}.disclaimer{font-size:75%}.intro{text-align:center}.intro__image{margin:auto;margin-top:120px;width:200px;height:200px}.intro__title{margin-bottom:50px;text-align:center}.intro__lead{color:#aaa;font-size:1.5em;margin-top:30px;font-weight:300;font-style:italic;margin-bottom:120px;margin-top:120px}.social{list-style-type:none;text-align:center;list-style-position:outside;display:block;padding:0;margin:0}.social li{display:inline;padding:0 5px}.social li a{display:inline-block;width:35px;height:35px;color:#404040}.social svg{fill:#848d95;width:35px !important;height:35px !important}aside{display:none}.pagination{width:100%;margin-bottom:20px}.pagination div{width:50%;height:10px}.pagination__previous-url{text-align:left;float:left}.pagination__next-url{text-align:right;float:right}.pagination__previous-arrow,.pagination__next-arrow{width:10%;display:inline-block;vertical-align:middle;text-align:center}.pagination__previous-title,.pagination__next-title{width:85%;display:inline-block;vertical-align:middle;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.project div.description p{margin:10px 0}.project dl{margin:0;font-size:0.9em}.project dl dt{width:130px;float:left;height:22px}.project dl dd{height:22px}.project h2.approved{background:url(approved.png) 6px 8px no-repeat;margin-left:-30px;padding-left:30px}.project p.approved{color:#888;font-size:14px}.certification-logo{width:300px}.image-wrapper{text-align:center}.image-wrapper .image-caption{color:#828282;margin-top:10px}.alert-success{color:green}.alert-danger{color:red}.add{display:block !important;max-width:420px;width:420px;margin:15px 15px 0 15px;padding:15px;height:100px;max-height:100px;background-color:white}@media screen and (max-width: 740px){.header,main{display:flexbox;display:-ms-flexbox;display:-webkit-box;display:-ms-flexbox;-moz-box-orient:vertical;-webkit-box-orient:vertical;-moz-box-align:center;-webkit-box-align:center;-ms-flex-flow:column;flex-flow:column;width:100%}#side,#content{flex:1;-webkit-box-flex:1 auto;-moz-box-flex:1 auto;-ms-flex:1 auto;width:100%;max-width:100%;position:relative}#content{margin-left:0px}aside{display:none}}@media screen and (max-width: 480px){#content img{display:block;width:100%;max-width:100%;max-height:100%}#content article{margin:10px;padding:0}.excerpt a.title{font-size:1.4em}.excerpt .tags{margin-left:0;padding-left:0}.pagination div{width:100%;height:initial}}span.icon>.fa{cursor:default}.admonitionblock td.icon{text-align:center;width:80px}.admonitionblock td.content{width:100%}.admonitionblock td.icon [class^="fa icon-"]{font-size:1.5em;text-shadow:1px 1px 2px rgba(0,0,0,0.5);cursor:default}.admonitionblock td.icon .icon-note:before{content:"\f05a";content:"📎";color:#19407c}.admonitionblock td.icon .icon-tip:before{content:"\f0eb";content:"💡";text-shadow:1px 1px 2px rgba(155,155,0,0.8);color:#111}.admonitionblock td.icon .icon-warning:before{content:"\f071";content:"⚠";color:#bf6900}.admonitionblock td.icon .icon-caution:before{content:"\f06d";content:"🔥";color:#bf3400}.admonitionblock td.icon .icon-important:before{content:"\f06a";content:"❗";color:#bf0000}pre .conum[data-value]{position:relative;top:-.125em}.conum[data-value]{display:inline-block;color:#fff !important;background-color:rgba(0,0,0,0.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}.conum[data-value]+b{display:none}.conum[data-value]::after{content:attr(data-value)}.hdlist>table,.colist>table{border:0;background:none}.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}.colist td:not([class]):last-child{padding:.25em 0}.colist>table>tbody>tr,.colist>table>tbody>tr>td{border:none}.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,0.3)}.CodeRay .line-numbers strong{color:rgba(0,0,0,0.4)}table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}table.CodeRay td{vertical-align:top;line-height:1.45}table.CodeRay td.line-numbers{text-align:right}table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,0.3)}table.CodeRay td.code{padding:0 0 0 .5em}table.CodeRay td.code>pre{padding:0}.CodeRay .debug{color:#fff !important;background:#000080 !important}.CodeRay .annotation{color:#007}.CodeRay .attribute-name{color:#000080}.CodeRay .attribute-value{color:#700}.CodeRay .binary{color:#509}.CodeRay .comment{color:#998;font-style:italic}.CodeRay .char{color:#04d}.CodeRay .char .content{color:#04d}.CodeRay .char .delimiter{color:#039}.CodeRay .class{color:#458;font-weight:bold}.CodeRay .complex{color:#a08}.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}.CodeRay .color{color:#099}.CodeRay .class-variable{color:#369}.CodeRay .decorator{color:#b0b}.CodeRay .definition{color:#099}.CodeRay .delimiter{color:#000}.CodeRay .doc{color:#970}.CodeRay .doctype{color:#34b}.CodeRay .doc-string{color:#d42}.CodeRay .escape{color:#666}.CodeRay .entity{color:#800}.CodeRay .error{color:#808}.CodeRay .exception{color:inherit}.CodeRay .filename{color:#099}.CodeRay .function{color:#900;font-weight:bold}.CodeRay .global-variable{color:#008080}.CodeRay .hex{color:#058}.CodeRay .integer,.CodeRay .float{color:#099}.CodeRay .include{color:#555}.CodeRay .inline{color:#000}.CodeRay .inline .inline{background:#ccc}.CodeRay .inline .inline .inline{background:#bbb}.CodeRay .inline .inline-delimiter{color:#d14}.CodeRay .inline-delimiter{color:#d14}.CodeRay .important{color:#555;font-weight:bold}.CodeRay .interpreted{color:#b2b}.CodeRay .instance-variable{color:#008080}.CodeRay .label{color:#970}.CodeRay .local-variable{color:#963}.CodeRay .octal{color:#40e}.CodeRay .predefined{color:#369}.CodeRay .preprocessor{color:#579}.CodeRay .pseudo-class{color:#555}.CodeRay .directive{font-weight:bold}.CodeRay .type{font-weight:bold}.CodeRay .predefined-type{color:inherit}.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}.CodeRay .key{color:#808}.CodeRay .key .delimiter{color:#606}.CodeRay .key .char{color:#80f}.CodeRay .value{color:#088}.CodeRay .regexp .delimiter{color:#808}.CodeRay .regexp .content{color:#808}.CodeRay .regexp .modifier{color:#808}.CodeRay .regexp .char{color:#d14}.CodeRay .regexp .function{color:#404;font-weight:bold}.CodeRay .string{color:#d20}.CodeRay .string .string .string{background:#ffd0d0}.CodeRay .string .content{color:#d14}.CodeRay .string .char{color:#d14}.CodeRay .string .delimiter{color:#d14}.CodeRay .shell{color:#d14}.CodeRay .shell .delimiter{color:#d14}.CodeRay .symbol{color:#990073}.CodeRay .symbol .content{color:#a60}.CodeRay .symbol .delimiter{color:#630}.CodeRay .tag{color:#008080}.CodeRay .tag-special{color:#d70}.CodeRay .variable{color:#036}.CodeRay .insert{background:#afa}.CodeRay .delete{background:#faa}.CodeRay .change{color:#aaf;background:#007}.CodeRay .head{color:#f8f;background:#505}.CodeRay .insert .insert{color:#080}.CodeRay .delete .delete{color:#800}.CodeRay .change .change{color:#66f}.CodeRay .head .head{color:#f4f}.browserupgrade{margin:0.2em 0;background:#ccc;color:#000;padding:0.2em 0}@media print{*,*:before,*:after{background:transparent !important;color:#000 !important;-webkit-box-shadow:none !important;box-shadow:none !important;text-shadow:none !important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="#"]:after,a[href^="javascript:"]:after{content:""}pre{white-space:pre-wrap !important}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}}</style><script> var htmlElement = document.getElementsByTagName('html')[0]; htmlElement.style.display = 'none'; htmlElement.className = htmlElement.className.replace('no-js', 'js'); htmlElement.style.overflow = 'hidden'; // Redirect to https var host = "https://dareenzo.github.io"; if (host == window.location.host && window.location.protocol != "https:") { window.location.protocol = "https"; } </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Yrsa|Open+Sans"> <!-- Google Tag Manager --> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-NCKZVZ');</script> <!-- End Google Tag Manager --><body lang="pt"> <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCKZVZ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) --> <!--[if lte IE 9]><p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security. <![endif]--><header class="header"><article class="about"> <a href="/"><img class="logo" src="/assets/images/avatar.svg" alt="Paulo Phagula" /></a><h2>Paulo Phagula</h2><p>Musings and Scribbles on Software Development <!--<p class="navigation"> <a href="/about#work" title="Check out some of my work and projects">#work</a> <a href="https://github.com/dareenzo" title="Have a look at my code on github" target="_blank">#code</a> <a href="https://kodikos-io.github.io" title="Check out my Startup Kodikos" target="_blank">#startup</a> --></article><nav class="header__navigation"><ul class="navigation"><li><a class="page-link" href="/blog" title="Read my articles">Articles</a><li><a class="page-link" href="/talks" title="">Talks</a><li><a class="page-link" href="/about" title="Learn more about me and this site">About</a> <!--<li><a class="page-link" href="/services" title="Check out what I can do for you">Services</a><li><a class="page-link" href="/work" title="View some my most notable work and projects">Portfolio</a><li><a class="page-link" href="/contact" title="Get my contacts details so you can reach out to me">Contact</a> --></ul></nav><!-- <form name="search" method="get" action="/search"> <input class="header__search-box" type="search" placeholder="Search ..." name="q" /> </form> --></header><main><section id="content"><article><h1 class="article__title">Restaurando um backup de Share Point usando apenas a base dados</h1><header><div class="article__meta"> <i class="fa fa-calendar-o" aria-hidden="true"></i> <time class="article__post-date" datetime="2014-07-26T09:57:07+02:00" itemprop="datePublished" content="2014-07-26T09:57:07+02:00">26 Jul 2014</time> | <i class="fa fa-folder-o" aria-hidden="true"></i> Coding <br/> <span class="article__tags"> <i class="fa fa-tags" aria-hidden="true"></i> Database&nbsp; Note&nbsp; SQLServer&nbsp; SharePoint&nbsp; </span></div><p class="article__excerpt"><p>Então você tem que restaurar um backup de SharePoint mas não consegue fazê-lo usando a interface do <em>Central Administration</em>, pelos mais variados erros. No entanto, você tem acesso directo a base de dados de conteúdo via SQL Server ou consegue identificar o ficheiro de backup da base de dados de conteúdo dos outros  na pasta onde tem o backup da <em>farm</em> do SharePoint.</header><p>Então você tem que restaurar um backup de SharePoint mas não consegue fazê-lo usando a interface do <em>Central Administration</em>, pelos mais variados erros. No entanto, você tem acesso directo a base de dados de conteúdo via SQL Server ou consegue identificar o ficheiro de backup da base de dados de conteúdo dos outros  na pasta onde tem o backup da <em>farm</em> do SharePoint.<ol><li>Primeiro faça o restore da base de dados no SQL Server.<li>Adicione a base de dados ao SharePoint via PowerShell, usando o comando: <code>stsadm -o addcontentdb - url &lt;nova url&gt; -databasename &lt;nome da base de dados restaurada&gt;</code></ol><p><!-- ![Adicionando Base de dados de conteudo ao sharepoint](/content/uploads/2014/07/Adicionando-Base-de-dados-de-conteudo-ao-sharepoint2-300x36.png) --><ol><li>Certifique de criar a <em>web application</em> para associar a base de dados. Ao fazer este passo o sharepoint irá criar uma base de dados de conteúdo, esta deverá ser retirada para dar espaço para associação da aplicação com a BD que realmente queremos usar.<li>Para dissociar a DB recentemente criada da aplicação primeiro obtemos o seu Id usando o comando <code>Get-SPContentDatabase</code> e depos usamos o comando <code>Dismount-SPContentDatabase</code> para a dissociação.</ol><p><!-- ![Dissociar DB de SharePoint](/content/uploads/2014/07/Dissasociar-DB-de-SharePoint-300x78.png) --><ol><li>Associamos a nossa BD de conteúdo a aplicação usando o comando <code>Mount-SPContentDatabase</code></ol><hr/><div class="sharing"><p> Share this on: <a title="Share article on Email" href="mailto:?subject=Restaurando um backup de Share Point usando apenas a base dados&body=https%3A%2F%2Fdareenzo.github.io%2Fblog%2F2014%2F07%2F26%2Frestoring-a-sharepoint-backup-with-the-database-only%2F">Mail</a> - <a title="Share article on Twitter" target="_blank" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fdareenzo.github.io%2Fblog%2F2014%2F07%2F26%2Frestoring-a-sharepoint-backup-with-the-database-only%2F&text=Restaurando%20um%20backup%20de%20Share%20Point%20usando%20apenas%20a%20base%20dados&via=dareenzo">Twitter</a> - <a title="Share article on Facebook" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fdareenzo.github.io%2Fblog%2F2014%2F07%2F26%2Frestoring-a-sharepoint-backup-with-the-database-only%2F">Facebook</a></div><div class="pagination"><div class="pagination__previous-url"> <a href="/blog/2014/07/25/measuring-query-progress-in-sql-server/" title="Measuring query progress in SQL Server with DBCC!" rel="prev"> <span class="pagination__previous-arrow"><i class="fa fa-long-arrow-left" aria-hidden="true"></i></span> <span class="pagination__previous-title">Measuring query progress in SQL Server with DBCC!</span> </a></div><div class="pagination__next-url"> <a href="/blog/2014/08/03/unit-tests-with-smtp/" title="Testes unitários com SmtpClient" rel="next"> <span class="pagination__next-title">Testes unitários com SmtpClient</span> <span class="pagination__next-arrow"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></span> </a></div><div class="clearfix"></div></div><div class="related-posts"></div><hr /><div class="comments"><p>Please, use <a href="https://help.disqus.com/customer/portal/articles/665057-syntax-highlighting">syntax highlighting</a> in your comments, to make them more readable.<div id="disqus_thread"></div><noscript>Please, enable JavaScript to see the <a href="http://disqus.com/?ref_noscript">comments</a></noscript></div></article><script> var disqus_config = function () { this.page.url = 'https://dareenzo.github.io/blog/2014/07/26/restoring-a-sharepoint-backup-with-the-database-only/'; this.page.identifier = 'https://dareenzo.github.io/blog/2014/07/26/restoring-a-sharepoint-backup-with-the-database-only/'; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://dareenzo.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></section><div class="clearfix"></div></main><footer class="footer"><ul class="social"><li><a href="mailto:pphagula@gmail.com" target="_blank" title="Drop me an email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a><li><a href="https://github.com/dareenzo" target="_blank" title="Fork my code on Github"><i class="fa fa-github" aria-hidden="true"></i></a><li><a href="https://stackoverflow.com/users/6270740/paulo-phagula" target="_blank" title="Help me out with some questions on StackOverflow"><i class="fa fa-stack-overflow" aria-hidden="true"></i></a><li><a href="https://www.linkedin.com/in/paulo-phagula" target="_blank" title="Connect with me on Linkedin if you, too, need to put up with this crap against your will"><i class="fa fa-linkedin" aria-hidden="true"></i></a><li><a href="https://twitter.com/dareenzo" target="_blank" title="Follow me on Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a><li><a href="/feed.rss.xml" target="_blank" title="Stay up-to-date with all the blog posts via RSS"><i class="fa fa-feed" aria-hidden="true"></i></a></ul><p class="copyright"> Copyright &copy; 2014 - 2019 Paulo Phagula.<br/> Some rights reserved</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/prism.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/plugins/toolbar/prism-toolbar.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.11.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.12.2/components/prism-python.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.12.2/components/prism-php.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.12.2/components/prism-ruby.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.12.2/components/prism-sql.js"></script> <script type="text/javascript"> htmlElement.style.display = 'block'; htmlElement.style.overflow = ''; </script>
